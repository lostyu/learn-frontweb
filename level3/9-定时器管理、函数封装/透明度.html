<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="telephone=no" name="format-detection">
    <title>透明度</title>
    <script>
    	function getStyle(obj, attr) {
    		return obj.currentStyle ? obj.currentStyle[attr] : getComputedStyle(obj,false)[attr];
    	}

    	window.onload = function() {
            var oBtn1 = document.getElementById('btn1'),
                oBtn2 = document.getElementById('btn2'),
                oDiv1 = document.getElementById('div1');

            oBtn1.onclick = function() {                
                fade(oDiv1, 9, 100);
            };


            function fade(obj, dir, target, endFn) {

                dir = (parseInt( getStyle(obj, 'opacity') )*100) < target ? dir : -dir;               
                
                clearInterval(obj.timer);

                obj.timer = setInterval(function() {
                    var speed = parseInt( getStyle(obj, 'opacity') )*100 + dir;

                    if(speed > target && dir > 0 || speed < target && dir < 0){
                        speed = target;
                    }

                    obj.style['opacity'] = speed / 100;

                    if(speed == target){
                        clearInterval(obj.timer);

                        if(typeof endFn == 'function'){
                            endFn();
                        }
                    }
                }, 30);
            }
    	};
    </script>
</head>
<body>
<button id="btn1">淡入</button>
<button id="btn2">淡出</button>
<div id="div1" style="width: 400px; height: 400px; background-color: red; opacity: 0;"></div>

</body>
</html>